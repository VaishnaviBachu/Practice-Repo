<aura:component  controller= "ContctCardAndMapsWithSearchctrl" implements="force:hasRecordId,force:hasSObjectName,flexipage:availableForRecordHome">
    <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>
    <aura:attribute name="conList" type="Contact[]" default=""/>
    <aura:attribute name="conVar" type="Contact" default=""/>
    <aura:attribute name="contactMarkerList" type="list" default="[]"/>
    
    <aura:attribute name="title" type="String" default="Custom Title"/>
    <aura:attribute name="markersTitle" type="String" /> 
    <aura:attribute name="modalopen" type="boolean" default= "false"/>
    <aura:attribute name="searchWord" type="string" default= ""/>
    <!-- input box and search button start -->
    <div class="container slds-p-around_x-large">
        <div class="slds-p-around_x-small">
            <lightning:layout verticalAlign ="end" horizontalAlign="spread">
                <lightning:layoutItem size="10">
                    <lightning:input value="{!v.searchWord}" name="input3"  placeholder="start typing here..."/>
                </lightning:layoutItem>
                <lightning:layoutItem size="6" padding="horizontal-medium">
                    <lightning:button label="Search" variant="brand" title="Search" onclick="{!c.handlesearch }" iconName="utility:search"/>
                    
                </lightning:layoutItem>
            </lightning:layout>
        </div> 
    </div>
    
    
    <aura:if isTrue="{!v.contactMarkerList.length>0}">
    <aura:iteration items="{!v.contactMarkerList}" var="conCard">
        
        <div class="slds-m-around_xx-large">
            <aura:if isTrue="{!conCard.modalopen}">
                <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                    <!--  Modal Start -->
                    <div class="slds-modal__container">
                        <!-- Header -->
                        <header class="slds-modal__header">
                            <lightning:buttonIcon iconName="utility:close"  
                                                  variant="bare-inverse" 
                                                  alternativeText="Close modal"
                                                  class="slds-modal__close"
                                                  onclick="{! c.closemodal }"/>
                            <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Additional information</h2>
                        </header>
                        <!-- Body -->
                        <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                            <p>
                                {!conCard.contactRec.Name}  
                            </p> 
                        </div>    
                        <!-- Footer -->
                        <footer class="slds-modal__footer">
                            <lightning:button name="{!conCard.contactRec.Id}" variant="brand" label="OK" title="OK" onclick="{!c.handleok }" />
                        </footer>    
                        
                    </div>
                </section>
            </aura:if>    
        </div>
        
        <div class="slds-p-around_x-large">   
            <lightning:card>
                <aura:set attribute="title">
                    <lightning:icon iconName="utility:connected_apps" size="small"/>
                    {!conCard.contactRec.Name}
                </aura:set>
                
                
                
                <aura:set attribute="footer">
                    <lightning:button value="{!conCard.contactRec.Id}" label="View Details" title="View Details" onclick="{!c.handleClick }"/>
                    
                </aura:set>
                
                <div class="slds-p-around_small">
                    
                    <p class="field-title slds-text-title_bold" title="Contact Name">Contact Name</p>
                    <p>{!conCard.contactRec.Name}</p>
                </div> 
                <div class="slds-p-around_small">
                    
                    <p class="field-title slds-text-title_bold" title="Contact Title">Contact Title</p>
                    <p>{!conCard.contactRec.Title}</p>
                </div> 
                <div class="slds-p-around_small">
                    
                    <p class="field-title slds-text-title_bold" title="Contact Phone">Contact Phone</p>
                    <p>{!conCard.contactRec.Phone}</p>
                </div> 
                <div class="slds-p-around_small">
                    
                    <p class="field-title slds-text-title_bold" title="Contact AccountId">Contact AccountId</p>
                    <p>{!conCard.contactRec.AccountId}</p>
                </div> 
                <lightning:layoutItem size="4">          
                    <aura:if isTrue="{!conCard.contactMarker.length>0}">
                    <lightning:map  mapMarkers="{! conCard.contactMarker }"   zoomLevel="{!v.zoomLevel}" />
                    </aura:if>
                </lightning:layoutItem>
                
                
            </lightning:card>
        </div>
    </aura:iteration>
        </aura:if>
    
</aura:component>